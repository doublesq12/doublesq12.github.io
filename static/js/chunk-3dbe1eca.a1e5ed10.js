(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3dbe1eca"],{1427:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form-item",{attrs:{label:e.title}},[a("el-input",{attrs:{placeholder:"请输入",clearable:!0,maxlength:e.number,"show-word-limit":""},model:{value:e.input,callback:function(t){e.input=t},expression:"input"}})],1)},i=[],r={components:{},props:{title:{type:String,default:""},model:{type:String,default:""},number:{type:String,default:""},maxlength:{type:String,default:""},prop:{type:Array}},data:function(){return{input:""}},computed:{},watch:{input:{handler:function(e,t){this.$emit("update:model",e)}}},created:function(){},mounted:function(){},methods:{}},s=r,o=(a("e773"),a("2877")),l=Object(o["a"])(s,n,i,!1,null,"490c980f",null);t["a"]=l.exports},1638:function(e,t,a){"use strict";a("cfc5")},"1e92":function(e,t,a){},"22a1":function(e,t,a){},"57eb":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{title:e.title,visible:e.visible,width:"40%","before-close":e.handleClose},on:{"update:visible":function(t){e.visible=t}}},[e._t("default")],2)],1)},i=[],r={components:{},props:{title:{type:String,required:!0},visible:{type:Boolean,required:!0}},data:function(){return{}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{handleClose:function(){this.$emit("update:visible",!1)}}},s=r,o=a("2877"),l=Object(o["a"])(s,n,i,!1,null,"3051db4d",null);t["a"]=l.exports},7217:function(e,t,a){"use strict";a("22a1")},"8e16":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.img?e._e():a("el-table-column",{attrs:{prop:e.label,label:e.title,type:e.type,index:e.indexmethod}},[e._t("default")],2),e.img?a("el-table-column",{attrs:{prop:e.label,label:e.title,type:e.type,index:e.indexmethod},scopedSlots:e._u([{key:"default",fn:function(e){return[a("el-image",{staticStyle:{width:"30px",height:"30px"},attrs:{src:e.row.skuImage}})]}}],null,!1,3073901032)}):e._e()],1)},i=[],r={components:{},props:{title:{type:String,required:!1},label:{type:String,required:!1},type:{type:String,required:!1},pag:{type:String},img:{type:Boolean,default:!1}},data:function(){return{}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{indexmethod:function(e){return this.pag+e-9}}},s=r,o=a("2877"),l=Object(o["a"])(s,n,i,!1,null,"be37c312",null);t["a"]=l.exports},ab94:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-button",{staticClass:"search",class:e.color,attrs:{disabled:e.disable,type:"primary",icon:e.icon},nativeOn:{click:function(t){return e.btn(t)}}},[e._v(e._s(e.title))])},i=[],r={components:{},props:{color:{type:String,default:"search"},title:{type:String,default:"搜索"},icon:{type:String,default:"icon"},disable:{type:Boolean,default:!1}},data:function(){return{}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{btn:function(){this.$emit("click")}}},s=r,o=(a("7217"),a("2877")),l=Object(o["a"])(s,n,i,!1,null,"53ec6d56",null);t["a"]=l.exports},ac79:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"i",(function(){return r})),a.d(t,"g",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"l",(function(){return l})),a.d(t,"j",(function(){return c})),a.d(t,"k",(function(){return u})),a.d(t,"b",(function(){return d})),a.d(t,"f",(function(){return m})),a.d(t,"h",(function(){return p})),a.d(t,"d",(function(){return f}));var n=a("b775"),i=function(e){return Object(n["a"])({url:"/api/vm-service/region/search",params:e})},r=function(e){return Object(n["a"])({url:"/api/vm-service/region",method:"POST",data:e})},s=function(e,t){return Object(n["a"])({url:"/api/vm-service/region/"+t,method:"PUT",data:e})},o=function(e){return Object(n["a"])({url:"/api/vm-service/region/"+e,method:"DELETE"})},l=function(e){return Object(n["a"])({url:"/api/vm-service/node/search",params:e})},c=function(e){return Object(n["a"])({url:"/api/vm-service/node",method:"POST",data:e})},u=function(e){return Object(n["a"])({url:"/api/user-service/partner/search",params:e})},d=function(){return Object(n["a"])({url:"/api/vm-service/businessType"})},m=function(e){return Object(n["a"])({url:"/api/vm-service/node/vmList/"+e})},p=function(e,t){return Object(n["a"])({url:"/api/vm-service/node/"+t,method:"PUT",data:e})},f=function(e){return Object(n["a"])({url:"/api/vm-service/node/"+e,method:"DELETE"})}},cb38:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pointManagement"},[a("div",{staticClass:"top"},[a("el-form",{staticClass:"form",attrs:{"label-position":"right","label-width":"80px"}},[a("search",{attrs:{title:"点位搜索:",model:e.searchInput},on:{"update:model":function(t){e.searchInput=t}}}),a("el-form-item",{attrs:{label:"区域搜索"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择",clearable:!0},model:{value:e.input,callback:function(t){e.input="string"===typeof t?t.trim():t},expression:"input"}},e._l(e.areaManagementData.currentPageRecords,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("lsButton",{attrs:{icon:"el-icon-search",size:"mini",title:"查询"},on:{click:function(t){return e.getPointManagementList()}}})],1)],1),a("div",{staticClass:"new"},[a("lsButton",{attrs:{icon:"el-icon-circle-plus-outline",size:"mini",title:"新建",color:"addBtn"},on:{click:e.newClick}}),a("el-table",{ref:"aabb",attrs:{data:e.pointManagementData.currentPageRecords,"empty-text":"暂无数据"}},[a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"viewDetails",attrs:{type:"text"},on:{click:function(a){return e.viewDetailsClick(t.row)}}},[e._v("查看详情")]),a("el-button",{staticClass:"modify",attrs:{type:"text"},on:{click:function(a){return e.modifyClick(t.row)}}},[e._v("修改")]),a("el-button",{staticClass:"del",attrs:{type:"text"},on:{click:function(a){return e.delClick(t.row)}}},[e._v("删除")])]}}])}),a("tableColumn",{attrs:{title:"序号",type:"index",pag:e.pointManagementData.pageIndex}}),a("tableColumn",{attrs:{title:"点位名称",label:"name"}}),a("tableColumn",{attrs:{title:"所在区域",label:"region.name"}}),a("tableColumn",{attrs:{title:"商圈类型",label:"businessType.name"}}),a("tableColumn",{attrs:{title:"合作商",label:"ownerName"}}),a("tableColumn",{attrs:{title:"详细地址",label:"addr"}})],1),a("el-dialog",{staticClass:"newDialog",attrs:{visible:e.dialogVisible,width:"50%","before-close":e.handleClose,title:e.dialogShow?"新增点位":"修改点位"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"form",staticClass:"demo-ruleForm",attrs:{model:e.formData,rules:e.formRules,"label-width":"100px","reset-fields":""}},[a("el-form-item",{attrs:{label:"点位名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入",maxlength:"15","show-word-limit":""},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),a("el-form-item",{attrs:{label:"所在区域",prop:"regionId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择",clearable:!0},model:{value:e.formData.regionId,callback:function(t){e.$set(e.formData,"regionId","string"===typeof t?t.trim():t)},expression:"formData.regionId"}},e._l(e.areaManagementData.currentPageRecords,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"所属商圈",prop:"businessId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择",clearable:!0},model:{value:e.formData.businessId,callback:function(t){e.$set(e.formData,"businessId","string"===typeof t?t.trim():t)},expression:"formData.businessId"}},e._l(e.businessDistrictListData,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"归属合作商",prop:"ownerId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择",clearable:!0},model:{value:e.formData.ownerId,callback:function(t){e.$set(e.formData,"ownerId","string"===typeof t?t.trim():t)},expression:"formData.ownerId"}},e._l(e.numberPartnerSearchesData.currentPageRecords,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"详细地址",prop:"areaCode"}},[a("el-cascader",{ref:"cascader",attrs:{options:e.options,placeholder:"请选择"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node,i=t.data;return[a("span",[e._v(e._s(i.label))]),n.isLeaf?e._e():a("span",[e._v(" ("+e._s(i.children.length)+") ")])]}}]),model:{value:e.formData.areaCode,callback:function(t){e.$set(e.formData,"areaCode",t)},expression:"formData.areaCode"}})],1),a("el-form-item",{attrs:{prop:"addr"}},[a("el-input",{staticClass:"addressText",attrs:{type:"textarea",placeholder:"请输入详细地址",maxlength:"60","show-word-limit":""},model:{value:e.formData.addr,callback:function(t){e.$set(e.formData,"addr",t)},expression:"formData.addr"}})],1),a("div",{staticClass:"dialogButton"},[a("lsButton",{attrs:{size:"mini",title:"取消",color:"cancel"},on:{click:e.onClose}}),a("lsButton",{attrs:{size:"mini",title:"确认",color:"addBtn"},on:{click:e.onSave}})],1)],1)],1),a("Dialog",{staticClass:"newDialog",attrs:{visible:e.dialogVisible1,title:"点位详情"},on:{"update:visible":function(t){e.dialogVisible1=t}}},[a("div",{staticClass:"pointPosition"},[a("el-table",{ref:"aabb",attrs:{"empty-text":"暂无数据",data:e.PointDeatailsData.data}},[a("el-table-column",{attrs:{type:"index",label:"序号"}}),a("el-table-column",{attrs:{label:"机器编号",property:"innerCode"}}),a("el-table-column",{attrs:{label:"设备状态",property:"vmStatus"}}),a("el-table-column",{attrs:{property:"lastSupplyTime",label:"最后一次供货时间"}})],1)],1)])],1),a("div",{staticClass:"bottom"},[a("div",{staticClass:"left"},[a("span",[e._v("共"),a("span",[e._v(e._s(e.pointManagementData.totalCount))]),e._v("条记录")]),a("span",[e._v("第"),a("span",[e._v(e._s(e.pointManagementData.pageIndex))]),e._v("/"),a("span",[e._v(e._s(e.pointManagementData.totalPage))]),e._v("页")])]),a("div",{staticClass:"right"},[a("lsButton",{staticClass:"previousPage",attrs:{id:"previousPage",size:"mini",title:"上一页",color:"addBtn",disable:e.disable},on:{click:e.previousPageClick}}),a("lsButton",{staticClass:"nextPage",attrs:{id:"nextPage",size:"mini",title:"下一页",disable:e.disable1,color:"addBtn"},on:{click:e.nextPageClick}})],1)])])},i=[],r=a("c7eb"),s=a("1da1"),o=(a("b0c0"),a("d3b7"),a("159b"),a("ac1f"),a("5319"),a("ef6c")),l=a("1427"),c=a("8e16"),u=a("ab94"),d=a("ac79"),m=a("57eb"),p={name:"PointManagement",components:{search:l["a"],lsButton:u["a"],tableColumn:c["a"],Dialog:m["a"]},data:function(){return{pageIndex:1,selectedOptions:[],options:o["regionData"],pointManagementData:{},areaManagementData:{},numberPartnerSearchesData:{},businessDistrictListData:{},PointDeatailsData:{},disable:!1,disable1:!1,input:"",searchInput:"",dialogVisible:!1,dialogVisible1:!1,dialogShow:!0,itemId:"",formData:{name:"",addr:"",areaCode:"",createUserId:"",regionId:"",businessId:"",ownerId:"",ownerName:""},formRules:{name:[{required:!0,message:"请输入点位名称",trigger:"blur"}],addr:[{required:!0,message:"请输入详细地址",trigger:"blur"}],areaCode:[{required:!0,message:"请选择详细地址",trigger:"blur"}],regionId:[{required:!0,message:"请输入所属区域",trigger:"blur"}],businessId:[{required:!0,message:"请输入所在商圈",trigger:"blur"}],ownerId:[{required:!0,message:"请输入归属合作商",trigger:"blur"}]}}},computed:{},watch:{},created:function(){this.getPointManagementList(),this.getAreaLIst(),this.getBusinessDistrictList(),this.getNumberPartnerSearchesData()},mounted:function(){},methods:{getPointManagementList:function(){var e=this;return Object(s["a"])(Object(r["a"])().mark((function t(){var a;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["l"])({pageIndex:e.pageIndex,regionId:e.input,name:e.searchInput});case 2:a=t.sent,e.pointManagementData=a.data,console.log(e.pointManagementData);case 5:case"end":return t.stop()}}),t)})))()},getAreaLIst:function(){var e=this;return Object(s["a"])(Object(r["a"])().mark((function t(){var a;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["a"])({});case 2:a=t.sent,e.areaManagementData=a.data;case 4:case"end":return t.stop()}}),t)})))()},getBusinessDistrictList:function(){var e=this;return Object(s["a"])(Object(r["a"])().mark((function t(){var a;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["b"])();case 2:a=t.sent,e.businessDistrictListData=a.data;case 4:case"end":return t.stop()}}),t)})))()},getNumberPartnerSearchesData:function(){var e=this;return Object(s["a"])(Object(r["a"])().mark((function t(){var a;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["k"])({pageSize:1e4});case 2:a=t.sent,e.numberPartnerSearchesData=a.data;case 4:case"end":return t.stop()}}),t)})))()},previousPageClick:function(){this.pageIndex<2?this.disable=!0:(this.pageIndex--,this.getPointManagementList(),document.getElementById("nextPage").disabled=!1)},nextPageClick:function(){this.pageIndex>=this.pointManagementData.totalPage?this.disable1=!0:(this.pageIndex++,this.getPointManagementList(),this.disable=!1)},newClick:function(){var e=this;return Object(s["a"])(Object(r["a"])().mark((function t(){return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.dialogVisible=!0,e.dialogShow=!0,e.getAreaLIst(),e.getBusinessDistrictList(),e.getNumberPartnerSearchesData();case 5:case"end":return t.stop()}}),t)})))()},handleClose:function(){this.$refs.form.resetFields(),this.$refs["cascader"].panel.clearCheckedNodes(),this.dialogVisible=!1,this.formData={name:"",addr:"",areaCode:"",createUserId:"",regionId:"",businessId:"",ownerId:"",ownerName:""}},onClose:function(){this.dialogVisible=!1,this.handleClose()},onSave:function(){var e=this;return Object(s["a"])(Object(r["a"])().mark((function t(){var a,n;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.dialogShow){t.next=13;break}return t.next=3,e.$refs.form.validate();case 3:return e.formData.createUserId=e.$store.state.user.userId,e.formData.areaCode=e.formData.areaCode[2],t.next=7,Object(d["j"])(e.formData);case 7:a=t.sent,console.log(a),e.$message.success("新增区域成功"),e.dialogVisible=!1,t.next=20;break;case 13:return t.next=15,Object(d["h"])(e.formData,e.itemId);case 15:n=t.sent,console.log(n),e.$message.success("修改区域成功"),e.dialogVisible=!1,e.getPointManagementList();case 20:e.formData.regionName="",e.formData.remark="";case 22:case"end":return t.stop()}}),t)})))()},modifyClick:function(e){console.log(e),this.formData.name=e.name,this.formData.regionId=e.region.id,this.formData.businessId=e.businessType.id,this.formData.ownerId=e.ownerId,this.formData.addr=e.addr,this.formData.areaCode=e.areaCode,this.formData.createUserId=this.$store.state.user.userId,this.itemId=e.id,this.dialogVisible=!0,this.dialogShow=!1},viewDetailsClick:function(e){var t=this;return Object(s["a"])(Object(r["a"])().mark((function a(){var n;return Object(r["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.dialogVisible1=!0,a.next=3,Object(d["f"])(e.id);case 3:n=a.sent,t.PointDeatailsData=n,console.log(n),t.vmStatusConversion(),t.lastSupplyTimeConversion();case 8:case"end":return a.stop()}}),a)})))()},vmStatusConversion:function(){this.PointDeatailsData.data.forEach((function(e){return 0===e.vmStatus?e.vmStatus="未投放":1===e.vmStatus?e.vmStatus="运营":e.vmStatus="撤机"}))},lastSupplyTimeConversion:function(){this.PointDeatailsData.data.forEach((function(e){return e.lastSupplyTime=e.lastSupplyTime.replace("-",".").replace("-",".").replace("T"," "),e.lastSupplyTime}))},delClick:function(e){var t=this;return Object(s["a"])(Object(r["a"])().mark((function a(){var n;return Object(r["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(d["d"])(e.id);case 2:n=a.sent,console.log(n),t.getPointManagementList();case 5:case"end":return a.stop()}}),a)})))()}}},f=p,b=(a("1638"),a("2877")),g=Object(b["a"])(f,n,i,!1,null,"c7a21198",null);t["default"]=g.exports},cfc5:function(e,t,a){},e773:function(e,t,a){"use strict";a("1e92")}}]);